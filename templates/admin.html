<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
    <style>
      body {
        background: radial-gradient(
          circle,
          rgb(251, 63, 185) 0%,
          rgb(8, 5, 5) 100%
        );
      }
      h1 {
        color: #f6c6ce;
        text-shadow: black 3px 3px 1px;
      }
    </style>
  </head>
  <body class="mx-auto p-4 w-full max-w-3xl">
    <div class="flex flex-col gap-4">
      <div class="w-full flex flex-col">
        <img
          src="/static/genaistudio.png"
          alt="Genaistudio"
          class="max-w-sm mx-auto"
        />
        <h1 class="text-3xl font-bold text-center mt-8 mb-3">Studio Screen Manager</h1>
<button
          class="text-right text-white font-bold py-2 "
          onclick="document.getElementById('imageModal').style.display='block'"
        >
          Screen locations & ids
      </button>
        <form
          action="/admin/update"
          method="post"
          class="bg-white shadow-md rounded px-8 pt-6 pb-8 "
        >
          {% for i in range(6) %}
          <div class="mb-4" x-data="{ selectedType: 'url' }">
            
            <label
              class="block text-gray-700 text-sm font-bold mb-2"
              for="screen1"
            >
              {{screens[i].name}} 
              
                {% if screens[i].connected %}
              <span class="text-green-500">[Connected]</span> <!-- Checkmark icon -->
                {% else %}
                <span class="text-red-500 cursor-pointer" onclick="const next = this.nextElementSibling; next.style.display = next.style.display === 'block' ? 'none' : 'block'">[Not connected ?]</span> <!-- Cross icon -->
                <span style="display: none" class="border p-3">
                  This screen is currently not connected. This means it is not running a browser window with the screen controller web app. <br/>
                  Make sure it is running a browser window in fullscreen with the following url:<br/><br/>
                  http://studiopi:8000/screen/{{ screens[i].id }} (Sometimes the domain needs to be studiopi.local ðŸ¤·)
                </span>
                {% endif %}

            </label>


            <div class="flex items-center w-full gap-2">
              <div class="flex items-center w-full">
                <div class=" mr-1 border rounded py-2 px-3 shadow h-10 bg-gray-200">
                <select
                  name="screen{{i+1}}_type"
                  class="bg-gray-200"
                  x-model="selectedType"
                  value="{{ screens[(i)].type }}"
                  @change="selectedType = $event.target.value"
                  x-init="selectedType = '{{ screens[(i)].type }}'"
                >
                  <option value="url">Url</option>
                  <option value="text">Text</option>
                  <option value="video">Video</option>
                  <option value="picture">Picture</option>
                  <option value="pdf">PDF</option>
                  <option value="default">Default</option>
                </select>
                </div>
                <input
                  class="shadow appearance-none border rounded w-full h-10 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                  type="text"
                  name="screen{{i+1}}_url"
                  value="{{ screens[(i)].url }}"
                  x-show="selectedType === 'url'"
                />
                <input
                  class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                  type="text"
                  name="screen{{i+1}}_text"
                  value="{{ screens[(i)].text }}"
                  x-show="selectedType === 'text'"
                />
                
                <select
                  name="screen{{i+1}}_picture"
                  class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                  x-show="selectedType === 'picture'"
                  x-init="$nextTick(() => $el.value = '{{ screens[(i)].picture }}')"
                >
                  <option value="">Select a picture</option>
                  {% for picture in pictures %}
                  <option value="{{ picture }}" {% if picture == screens[i].picture %}selected{% endif %}>
                  {{ picture }}
                  </option>
                  {% endfor %}
                </select>

                <select
                  name="screen{{i+1}}_video"
                  class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                  x-show="selectedType === 'video'"
                  value="{{ screens[(i)].video }}"
                >
                  <option value="">Select a video</option>
                  {% for video in videos %}
                  <option value="{{ video }}" {% if video == screens[i].video %}selected{% endif %}>
                  {{ video }}
                  </option>
                  {% endfor %}
                </select>

                <select
                  name="screen{{i+1}}_pdf"
                  class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                  x-show="selectedType === 'pdf'"
                  value="{{ screens[(i)].pdf }}"
                >
                  <option value="">Select a pdf</option>
                  {% for pdf in pdfs %}
                  <option value="{{ pdf }}" {% if pdf == screens[i].pdf %}selected{% endif %}>
                  {{ pdf }}
                  </option>
                  {% endfor %}
                </select>

              </div>

              <div>
                {% if screens[i].connected %}
                <button
                  class="bg-black hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                  type="submit"
                  name="update"
                  value="screen{{i+1}}"
                 
                >
                  Update
                </button>

                {% endif %} 
              </div>
            </div>
          </div>
          {% endfor %}

          <div class="flex items-center justify-between ">
            <button
              class="bg-black hover:bg-gray-700 text-white font-bold py-2  px-4 rounded focus:outline-none focus:shadow-outline"
              type="submit"
              name="update"
              value="all"
            >
              Update All
            </button>
          </div>
        </form>
        
      </div>
        
      

      <form
        action="/admin/upload_video"
        method="post"
        enctype="multipart/form-data"
        class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"
      >
        <div class="mb-4">
          <label
            class="block text-gray-700 text-sm font-bold mb-2"
            for="video_file"
          >
            Upload Video
          </label>
          <input
            type="file"
            name="video_file"
            id="video_file"
            accept="video/mp4"
            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          />
        </div>
        <button
          class="bg-black hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          type="submit"
        >
          Upload Video
        </button>
      </form>

      <!-- Add a new form for uploading pictures -->
      <form
        action="/admin/upload_picture"
        method="post"
        enctype="multipart/form-data"
        class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"
      >
        <div class="mb-4">
          <label
            class="block text-gray-700 text-sm font-bold mb-2"
            for="picture_file"
          >
            Upload Picture
          </label>
          <input
            type="file"
            name="picture_file"
            id="picture_file"
            accept="image/*"
            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          />
        </div>
        <button
          class="bg-black hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          type="submit"
        >
          Upload Picture
        </button>
      </form>


      <form
        action="/admin/upload_pdf"
        method="post"
        enctype="multipart/form-data"
        class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"
      >
        <div class="mb-4">
          <label
            class="block text-gray-700 text-sm font-bold mb-2"
            for="pdf_file"
          >
            Upload PDF
          </label>
          <input
            type="file"
            name="pdf_file"
            id="pdf_file"
            accept="pdf/*"
            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          />
        </div>
        <button
          class="bg-black hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          type="submit"
        >
          Upload Pdf
        </button>
      </form>

    </div>
    <!-- Modal -->
    <div
      id="imageModal"
      class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"
      style="display: none"
    >
      <div class="relative bg-white p-4 rounded shadow-lg mx-auto max-w-lg">
        <span
          class="absolute top-0 right-0 p-2 cursor-pointer"
          onclick="document.getElementById('imageModal').style.display='none'"
        >
          CLOSE
        </span>
        <img src="/static/studio.png" alt="Studio" class="max-w-full h-auto" />
      </div>
    </div>
  </body>
</html>
