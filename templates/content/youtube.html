/youtube.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Player</title>
    <style>
      body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #000;
      }
      #player {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
      }
    </style>
  </head>
  <body>
    <div id="player"></div>
    
    <script>
      // Extract YouTube video ID from URL
      function getYoutubeIdFromUrl(url) {
        const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
        const match = url.match(regExp);
        return (match && match[7].length === 11) ? match[7] : false;
      }
      
      // Load the YouTube IFrame Player API
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      
      var player;
      function onYouTubeIframeAPIReady() {
        // Get the video ID from the URL passed in the template
        const videoUrl = "{{ video_url }}";
        const videoId = getYoutubeIdFromUrl(videoUrl);
        
        if (!videoId) {
          document.getElementById('player').innerHTML = 'Invalid YouTube URL';
          return;
        }
        
        player = new YT.Player('player', {
          videoId: videoId,
          playerVars: {
            'autoplay': 1,
            'mute': 1,
            'controls': 0,
            'showinfo': 0,
            'rel': 0,
            'modestbranding': 1,
            'loop': 1,
            'playlist': videoId  // Required for looping
          },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }
      
      function onPlayerReady(event) {
        event.target.playVideo();
      }
      
      function onPlayerStateChange(event) {
        // If video ends, restart it (for backup looping)
        if (event.data === YT.PlayerState.ENDED) {
          player.playVideo();
        }
      }
    </script>
  </body>
</html>